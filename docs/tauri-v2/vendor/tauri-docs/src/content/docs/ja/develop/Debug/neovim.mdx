---
title: Neovim ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ã®ãƒ‡ãƒãƒƒã‚°
i18nReady: true
---

Neovim ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ Rust ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒãƒƒã‚°ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯æ•°å¤šãã‚ã‚Šã¾ã™ã€‚ã“ã®ç« ã§ã¯ã€`nvim-dap` ã¨ã„ãã¤ã‹ã®è¿½åŠ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¨­å®šã—ã¦ Tauri ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒãƒƒã‚°ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

> > > ã€Šè¨³æ³¨ã€‹ **dap**ã€€[Debug Adapter Protocol](https://microsoft.github.io/debug-adapter-protocol/) ã®ç•¥ã€‚é–‹ç™ºãƒ„ãƒ¼ãƒ«ï¼ˆIDE ã‚„ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãªã©ï¼‰ã¨ãƒ‡ãƒãƒƒã‚¬ãƒ¼é–“ã§ä½¿ç”¨ã•ã‚Œã‚‹æŠ½è±¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€‚

### äº‹å‰æº–å‚™

`nvim-dap` ã®æ‹¡å¼µæ©Ÿèƒ½ã«ã¯ `codelldb` ãƒã‚¤ãƒŠãƒªãŒå¿…è¦ã§ã™ã€‚[Github ã‚µã‚¤ãƒˆ](https://github.com/vadimcn/codelldb/releases) ã‹ã‚‰ã”è‡ªåˆ†ã®ã‚·ã‚¹ãƒ†ãƒ ã«é©åˆã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€è§£å‡ã—ã¦ãã ã•ã„ã€‚æ¬¡é …ã€Œ`nvim-dap` ã®è¨­å®šã€ã«å¿…è¦ã§ã™ã€‚

> > > ã€Šè¨³æ³¨ã€‹ **codelldb**ã€€LLDBãƒ‡ãƒãƒƒã‚¬ã‚’VSCodeã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã®æ‹¡å¼µæ©Ÿèƒ½ã€‚

### nvim-dap ã®è¨­å®š

[`nvim-dap`](https://github.com/mfussenegger/nvim-dap) ãŠã‚ˆã³ [`nvim-dap-ui`](https://github.com/rcarriga/nvim-dap-ui) ã®ä¸¡ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚github ã®ãƒšãƒ¼ã‚¸ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹æŒ‡ç¤ºã«å¾“ã†ã‹ã€ã‚ã‚‹ã„ã¯ãŠæ°—ã«å…¥ã‚Šã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ»ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚
ãªãŠã€`nvim-dap-ui` ã«ã¯ `nvim-nio` ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

æ¬¡ã«ã€ã€ŒNeovim è¨­å®šã€ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¨­å®šã—ã¾ã™ï¼š

```lua title="init.lua"
local dap = require("dap")

dap.adapters.codelldb = {
  type = 'server',
  port = "${port}",
  executable = {
    -- ã“ã®ãƒ‘ã‚¹ã¯ã€ã”è‡ªåˆ†ã®ã‚·ã‚¹ãƒ†ãƒ ã«åˆã‚ã›ã¦å¤‰æ›´ã—ã¦ãã ã•ã„ï¼
    command = '/opt/codelldb/adapter/codelldb',
    args = {"--port", "${port}"},
  }
}

dap.configurations.rust= {
  {
    name = "Launch file",
    type = "codelldb",
    request = "launch",
    program = function()
      return vim.fn.input('Path to executable: ', vim.fn.getcwd() .. '/target/debug/', 'file')
    end,
    cwd = '${workspaceFolder}',
    stopOnEntry = false
  },
}
```

ã“ã®ã€Œè¨­å®šã€ã§ã¯ã€ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã‚’èµ·å‹•ã™ã‚‹ãŸã³ã«ã€Œãƒ‡ãƒãƒƒã‚°ã‚’è¡Œãªã† Tauri App ãƒã‚¤ãƒŠãƒªã‚’æŒ‡å®šã™ã‚‹ã€ã‚ˆã†ã«æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã€ã€Œ`nvim-dap-ui` ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€ã‚’è¨­å®šã—ã¦ã€ãƒ‡ãƒãƒƒã‚°ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒé–‹å§‹ãŠã‚ˆã³åœæ­¢ã™ã‚‹ãŸã³ã«ã€Œãƒ‡ãƒãƒƒã‚¬ãƒ¼ãƒ»ãƒ“ãƒ¥ãƒ¼ã‚’è‡ªå‹•çš„ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã€ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š

```lua title="init.lua"
local dapui = require("dapui")
dapui.setup()

dap.listeners.before.attach.dapui_config = function()
  dapui.open()
end
dap.listeners.before.launch.dapui_config = function()
  dapui.open()
end
dap.listeners.before.event_terminated.dapui_config = function()
  dapui.close()
end
dap.listeners.before.event_exited.dapui_config = function()
  dapui.close()
end

```

æœ€å¾Œã«ã€ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ–¹æ³•ã‚’å¤‰æ›´ã§ãã¾ã™ï¼š

```lua title="init.lua"
vim.fn.sign_define('DapBreakpoint',{ text ='ğŸŸ¥', texthl ='', linehl ='', numhl =''})
vim.fn.sign_define('DapStopped',{ text ='â–¶ï¸', texthl ='', linehl ='', numhl =''})
```

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

ã‚¢ãƒ—ãƒªã®èµ·å‹•ã« Tauri CLI ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ãŸã‚ã€é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã¯è‡ªå‹•çš„ã«ã¯èµ·å‹•ã—ã¾ã›ã‚“ã€‚Neovim ã‹ã‚‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®çŠ¶æ…‹ã‚’åˆ¶å¾¡ã™ã‚‹ã«ã¯ã€[overseer ãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://github.com/stevearc/overseer.nvim/tree/master) ãŒåˆ©ç”¨ã§ãã¾ã™ã€‚

ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ã‚’åˆ¶å¾¡ã™ã‚‹æœ€è‰¯ã®æ–¹æ³•ã¯ã€[VS Code ã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚¿ã‚¹ã‚¯è¨­å®š](https://github.com/stevearc/overseer.nvim/blob/master/doc/guides.md#vs-code-tasks)ã€€ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã‚’è¡Œãªã†ã«ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« `.vscode/tasks.json` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ä»¥ä¸‹ã«ã€`trunk` ã‚’ä½¿ç”¨ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã€Œã‚¿ã‚¹ã‚¯è¨­å®šã€ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

```json title=".vscode/tasks.json"
{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "process",
      "label": "dev server",
      "command": "trunk",
      "args": ["serve"],
      "isBackground": true,
      "presentation": {
        "revealProblems": "onProblem"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^error:.*",
          "file": 1,
          "line": 2
        },
        "background": {
          "activeOnStart": false,
          "beginsPattern": ".*Rebuilding.*",
          "endsPattern": ".*server listening at:.*"
        }
      }
    }
  ]
}
```

### ã‚­ãƒ¼ã¸ã®ã‚³ãƒãƒ³ãƒ‰å‰²ã‚Šå½“ã¦ã®ä¾‹

ä»¥ä¸‹ã«ã€ãƒ‡ãƒãƒƒã‚°ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ãŠã‚ˆã³åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®ã‚­ãƒ¼ãƒ»ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆã‚­ãƒ¼ã¸ã®æ©Ÿèƒ½ã‚„è¨˜å·ã€ã‚³ãƒãƒ³ãƒ‰ã®å‰²ã‚Šå½“ã¦ï¼‰ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

```lua title="init.lua"
vim.keymap.set('n', '<F5>', function() dap.continue() end)
vim.keymap.set('n', '<F6>', function() dap.disconnect({ terminateDebuggee = true }) end)
vim.keymap.set('n', '<F10>', function() dap.step_over() end)
vim.keymap.set('n', '<F11>', function() dap.step_into() end)
vim.keymap.set('n', '<F12>', function() dap.step_out() end)
vim.keymap.set('n', '<Leader>b', function() dap.toggle_breakpoint() end)
vim.keymap.set('n', '<Leader>o', function() overseer.toggle() end)
vim.keymap.set('n', '<Leader>R', function() overseer.run_template() end)
```

<div style="text-align: right">
  ã€â€» ã“ã®æ—¥æœ¬èªç‰ˆã¯ã€ã€ŒDec 22, 2024 è‹±èªç‰ˆã€ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‘
</div>
